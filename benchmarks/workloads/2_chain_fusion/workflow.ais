// Chain Fusion Workflow
// Demonstrates FuseAskOps optimization - compiler batches dependent ask chains.
//
// The compiler now supports fusion through string interpolation (merge chains):
// - Traces through ais.merge operations to find ask producers
// - Collects static strings for template building
// - Fuses the entire chain into a single LLM call
//
// Expected results:
// - O0: 5 sequential LLM calls
// - O1: 1 fused LLM call -> 5x speedup

agent ChainFusion {
    @entry flow main() -> str {
        // Chain with string interpolation - FuseAskOps traces through merge ops
        ask("Define quantum computing in 2 sentences") -> step1
        ask("Using: " + step1 + ", explain qubits in 2 sentences") -> step2
        ask("Using: " + step2 + ", explain superposition in 2 sentences") -> step3
        ask("Using: " + step3 + ", explain entanglement in 2 sentences") -> step4
        ask("Summarize all concepts above in 2 sentences: " + step4) -> summary
        return summary
    }
}
